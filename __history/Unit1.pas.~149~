unit Unit1;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, Math, Vcl.ToolWin,
  Vcl.ActnMan, Vcl.ActnCtrls, Vcl.ActnMenus, Vcl.Menus,  Unit2;   Unit3;

type
  TForm1 = class(TForm)
    Label1: TLabel;
    SSS: TEdit;
    Button1: TButton;
    Label2: TLabel;
    chislo1: TEdit;
    Label4: TLabel;
    Label3: TLabel;
    Label5: TLabel;
    Edit3: TEdit;
    Edit4: TEdit;
    Edit5: TEdit;
    Memo1: TMemo;
    Label6: TLabel;
    procedure Button1Click(Sender: TObject);
//    procedure N32Click(Sender: TObject);
//    procedure N32Click(Sender: TObject);


//          procedure gistogram (intervalov: integer);
 //   procedure Memo1Change(Sender: TObject);
  //  procedure SSSChange(Sender: TObject);

//    procedure Edit5Change(Sender: TObject);
//    procedure chislo1Change(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form1: TForm1;
  n: integer;  //количество чисел
  chislo: real;
  s1: string;
  s2,s3: string;
  i,otstup,razryad,s: integer;
  vihod: array of real;
  Koef_Korr: Double; //Коэффициент корреляции
       mas_gist: array[0..29] of integer; //экспер. частота
       mas_p: array[0..29] of real; //вероятность
       Sr_Int: array[0..29] of real;
       Teor_Chast: array[0..29] of real;  //для значений теоретических частот(пирсон)
       Nakople_Teor_Chast: array[0..29] of real;  //для накопленных значений теоретических частот(колмогоров)
       Nakople_Mas_Gist: array[0..29] of integer; //для накопленных значений эксперим частот(колмогоров)
   f,size_int:real; //ширина интервала
   j,intervalov: integer;
   SR_KV_OTKL:real;//среднее квадратичное отклонение
   Sr_Ar:real;     //среднее арифметич.
   KOEF_OTKL:real;
   Disp: real; //дисперсия
   Par_A, Par_b: real; //параметры распределения a и b
   FX: real;   //плотность распределения
   Pirson: real;   //значение критерия Пирсона
   Max_nakople: real; //макс разница между накопленными частотами(колмогоров)
   Kolmogor: real; //значение критерия Колмогорова
   F_Korr: real; //корреляционная фунция
   Tau: integer; //задаваемый параметр для нахождения корр функции
   Sum_1, Sum_2, Sum_3, Sum_4, Sum_5: real; //для нахождения корр функции
   Disp_x, Disp_y: real; //Дисперсии сечений выборки
   Znach_Koef_Korr: real; //Для проверки коэффициента корреляции




implementation

{$R *.dfm}



procedure TForm1.Button1Click(Sender: TObject);
begin

      S:=strtoint(SSS.Text);
chislo:=strtofloat(chislo1.Text);
              setlength(vihod,s);
         for i:=0 to s-1 do begin
    vihod[i]:=Frac((i+1)*Pi) end;

   //Writeln(vihod);
  //gistogram(30);


      for I := 0 to s-1 do  begin
        Memo1.Lines.Add(FloatToStr(vihod[i]));
                            end;

   intervalov:=30;
   //mas_gist:=new integer[intervalov];
   ///заполняем интервалы
   size_int := 1/intervalov;
   f:=0;
   for j:=0 to intervalov-1 do begin
     for i:=0 to s-1 do  begin
       if (vihod[i]>f) and (vihod[i]<=f+size_int) then mas_gist[j]:=mas_gist[j]+1 end;
   f:=f+size_int
   end;
     ///находим среднее значения интервалов(Sr_Int)
   Sr_Int[0]:=size_int/2; //первое среднее
   for i:=1 to intervalov-1 do begin
   Sr_Int[i]:=size_int+Sr_Int[i-1] end;

     ///находим выборочную среднюю (Sr_Ar)
   for i:=0 to intervalov-1 do begin
     Sr_Ar:=Sr_Ar+Sr_Int[i]*mas_gist[i] end;
     Sr_Ar:=Sr_Ar/s;

     ///находим  выборочную дисперсию(Disp)
   for i:=0 to intervalov-1 do begin
     Disp:=Disp + mas_gist[i]*Sqr(Sr_Int[i] - Sr_Ar) end;
     Disp:=Disp/s;

     ///находим выборочное среднеквадратичное отклонение(SR_KV_OTKL)
     SR_KV_OTKL:=Sqrt(Disp);

     ///находим параметры распределения (Par_A, Par_b)
     Par_A:=Sr_Ar - Sqrt(3)*SR_KV_OTKL;
     Par_B:=Sr_Ar + Sqrt(3)*SR_KV_OTKL;

     ///находим предполагаемую плотность распределения Fx
     FX:=1/(Par_b-Par_A);

     ///находим теоретические частоты (первое и последнее значения считаются отдельно)
     Teor_Chast[0]:=s*(size_int - Par_A)*FX;
     Teor_Chast[29]:=s*(Par_b - (1 - size_int))*FX;
     for i:=1 to intervalov-2 do begin
       Teor_Chast[i]:=s*(Sr_Int[i+1] - Sr_Int[i])*FX  end;

     ///Находим значение критерия Пирсона
     for i:=0 to intervalov-1 do begin
     Pirson:=Pirson + Sqr(mas_gist[i] -  Teor_Chast[i])/Teor_Chast[i] end;
 ///создаем массивы с накопленными частотами(теор и практич) и находим максимульную разницу между накопленными частотами
     Nakople_Mas_Gist[0]:=Mas_Gist[0];
     Nakople_Teor_Chast[0]:=Teor_Chast[0];
     Max_nakople:=Nakople_Mas_Gist[0] - Nakople_Teor_Chast[0]; //начальный максимум
     for i:=1 to intervalov-1 do begin
       Nakople_Mas_Gist[i]:=Nakople_Mas_Gist[i-1]+Mas_Gist[i];
       Nakople_Teor_Chast[i]:=Nakople_Teor_Chast[i-1]+Teor_Chast[i];
       if Nakople_Mas_Gist[i] - Nakople_Teor_Chast[i] > Max_nakople then Max_nakople:=Nakople_Mas_Gist[i] - Nakople_Teor_Chast[i]
     end;
     Kolmogor:=Max_nakople/Sqrt(S);

     ///Находим корреляционную функцию (F_Korr)
     Tau:=3;
     for i:=0 to s-Tau-1 do begin
       ///Суммы для корр. функции
       Sum_1:=Sum_1 + vihod[i]*vihod[i+Tau];
       Sum_2:=Sum_2 + vihod[i];
       Sum_3:=Sum_3 + vihod[i+Tau];
       ///Суммы для дисперсии сечений выборки
       Sum_4:=Sum_4 + Sqr(vihod[i]);
       Sum_5:=Sum_5 + Sqr(vihod[i+Tau]);
     end;
     ///Находим значение корр. функции (F_Korr)
     F_Korr:= (1/(S-Tau))*Sum_1 - (1/Sqr(S-Tau))*Sum_2*Sum_3;
     ///Находим значения дисперсий Disp_x и Disp_y
     Disp_x:= (1/(S-Tau))*Sum_4 - (1/Sqr(S-Tau))*Sqr(Sum_2);
     Disp_y:= (1/(S-Tau))*Sum_5 - (1/Sqr(S-Tau))*Sqr(Sum_3);
     ///Находим коэфф. корреляции (Koef_Korr)
     Koef_Korr:= F_Korr/Sqrt(Disp_x*Disp_y);
   ///Для проверки коэфф. корреляции (при вероятности p=0.95)
     Znach_Koef_Korr:= (1-0.95)*Sqrt(1/S);

    // Writeln('Коэффициент корреляции:  ',Koef_Korr);
   //  Writeln('Проверка коэффициента корреляции:  ',Znach_Koef_Korr);
   //  Writeln('Колмогорov:  ',Kolmogor);
  //  Writeln('теор частота:  ', Teor_Chast);
 //   Writeln('a:  ', Par_A);
 //    Writeln('b:  ', Par_B);
  //  Writeln('Пирсон:  ', Pirson);
  //   Writeln('fx:  ', FX);
  //  Writeln(mas_gist);
   Edit3.Text:= FloatToStr(Kolmogor);
    Edit4.Text:= FloatToStr(Pirson);
   Edit5.Text:= FloatToStr(Koef_Korr);
     end;








end.
